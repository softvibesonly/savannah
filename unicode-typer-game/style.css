/* Toast shown when player skip-streak hits 3 (challenge nudge) */
#challenge-toast {
  position: fixed;
  bottom: calc(var(--footer-offset, 56px) + 18px);
  left: 50%;
  transform: translateX(-50%);
  font-family: 'Lato', -apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  font-weight: 700;
  font-size: 1.5rem;
  color: #5ab7e2;
  text-shadow: 0 1px 2px rgba(0,0,0,0.7), 0 0 2px rgba(0,0,0,0.4);
  pointer-events: none;
  white-space: nowrap;
  z-index: 999;
  opacity: 0;               /* hidden by default */
}
#challenge-toast.show { animation: toastReveal 1.2s cubic-bezier(0.2, 0, 0, 1) both; }

/* Quick dark-grey flash before masking a row */
@keyframes rowFlashDark {
  0% { background: #e5e7eb; }
  100% { background: inherit; }
}
.symbol-table tr.flash-mask { animation: rowFlashDark .25s ease-in; }
/* Toast shown when Stage 1 total rounds auto‑extends */
#round-extend-toast {
  position: fixed;
  bottom: calc(var(--footer-offset, 56px) + 18px);
  left: 50%;
  transform: translateX(-50%);
  font-family: 'Lato', -apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  font-weight: 700;
  font-size: 1.05rem;
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.7), 0 0 2px rgba(0,0,0,0.4);
  pointer-events: none;          /* non-interactive */
  white-space: nowrap;
  z-index: 999;                  /* above footer */
  opacity: 0;                    /* hidden by default */
}
#round-extend-toast.show {
  animation: toastReveal 2.1s cubic-bezier(0.2, 0, 0, 1) both;
}
@keyframes toastReveal {
  0%   { opacity: 0; transform: translateX(-50%) translateY(6px) scale(0.98); clip-path: inset(0 100% 0 0); }
  45%  { opacity: 1; transform: translateX(-50%) translateY(0) scale(1.03); }
  100% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1);    clip-path: inset(0 0 0 0); }
}

/* Footer round counter flash when the plan extends */
@keyframes roundBumpFlash {
  0%   { color: var(--muted); text-shadow: none; }
  10%  { color: #F54927; text-shadow: 0 0 6px rgba(245,73,39,0.35); }
  20%  { color: var(--muted); text-shadow: none; }
  35%  { color: #F54927; text-shadow: 0 0 6px rgba(245,73,39,0.35); }
  60%  { color: #C82909; text-shadow: 0 0 8px rgba(200,41,9,0.35); }
  100% { color: var(--muted); text-shadow: none; }
}
#round-counter.bump {
  animation: roundBumpFlash 1.3s ease-in-out;
}


/* Animate text color from black to primary */
@keyframes onboardingTitleColor {
  from {
    background: linear-gradient(45deg, #33a2bb, #234C75);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  to {

    color: #000000;
  }
}
*/

/* Inline controls row for Settings (audio + order) */
.inline-controls { display: flex; align-items: center; gap: .75rem; flex-wrap: wrap; }
.inline-controls .inline { display: inline-flex; align-items: center; }
.inline-controls .spacer { margin-left: .5rem; }

/* Make selects visually align with buttons */
select {
  height: 34px;
  padding: 0 0.6rem;
  border-radius: 0.5rem;
  border: 1px solid var(--border);
  background: rgba(255,255,255,0.85);
  backdrop-filter: saturate(1.1) blur(4px);
  min-width: 140px;
}
/*
  Global variables to establish the colour palette used throughout the
  application.  Adjust to make it look how u want. 
  The palette tries to emphaisze clarity and
  accessibility by pairing muted backgrounds with high‑contrast text
  and vivid accent colours for feedback.

  Todo: Add colorblind accessibility modes.
*/
:root {
  --background: #f9fafb;
  --surface: #ffffff;
  --primary: #4c6ef5;        /* indigo */
  --primary-dark: #374fc9;
  --notcringeyblue: #285684;
  --success: #22c55e;        /* green */
  --error: #ef4444;          /* red */
  --text: #1f2937;           /* dark slate */
  --muted: #6b7280;          /* grey */
  --border: #e5e7eb;
  --math-font: 'LatinModernMath', 'STIXTwoMath', 'STIX Two Math', 'Cambria Math', 'Latin Modern Math', 'TeX Gyre Termes Math', 'Asana Math', 'Noto Serif Math', 'Times New Roman', serif;
}

@font-face {
  font-family: 'LatinModernMath';
  src: url('./fonts/LatinModernMath-Regular.otf') format('opentype');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'STIXTwoMath';
  src: url('./fonts/STIXTwoMath-Regular.ttf') format('truetype');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

/* Reset to default */
html, body {
  margin: 0;
  padding: 0;
  font-family: -apple-system, system-ui, 'Helvetica Neue', Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
  background: var(--background);
  color: var(--text);
  height: 100%;
  overflow-x: hidden;
  font-size: 17px;
}

button, select {
  font-family: inherit;
  font-size: 1rem;
}

/* Utility class to hide elements. */
.hidden {
  display: none !important;
}

/* Modal overlay shared by onboarding and settings screens. */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.modal-content {
  /* Lighter "glass" card with narrower default width */
  background: rgba(255, 255, 255, 0.92);
  backdrop-filter: saturate(1.15) blur(12px);
  -webkit-backdrop-filter: saturate(1.15) blur(12px);
  padding: 2rem;
  border-radius: 0.9rem;
  border: 1px solid rgba(255,255,255,0.6);
  box-shadow: 0 12px 30px rgba(20,25,40,0.22),
              0 1px 0 rgba(255,255,255,0.75) inset;
  max-width: 720px;                 /* narrower than before (I alr forgot what it was before though lol */
  width: min(92vw, 760px);          /* keep responsive but less wide */
  max-height: 90vh;
  overflow-y: auto;
}

/* Trying to make this animation work */
.modal-content h1::before {
  content: attr(data-text); /* Use a data attribute for the text */
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  color: #000; /* This is our black overlay text */
  z-index: 1;
  opacity: 1; /* Starts fully visible */
}

.modal-content h1 {
  margin-top: 0;
  text-align: center;
  position: relative; /* Needed for the ::before overlay */
  background: linear-gradient(45deg, #2c5e90, #234C75);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  color: transparent;
}

.modal-content h2 {
  margin-top: 0;
  color: var(--primary);
}
.modal-content h1 { text-align: center; }

/* Animate onboarding modal h1 color when modal is visible */
#onboarding:not(.hidden) .modal-content h1 {
  animation: onboardingTitleColor 2.5s cubic-bezier(0.5,0,0.2,1) 1;
}

.form-group {
  margin-bottom: 1rem;
}

.primary-button {
  display: inline-block;
  background: linear-gradient(180deg, #2c5e90, #234C75);
  color: #fff;
  padding: 0.8rem 1.6rem;
  border: 1px solid #1c3a59;
  border-radius: 0.75rem;
  cursor: pointer;
  transition: transform .05s ease, box-shadow .2s ease, background .2s ease;
  box-shadow: 0 6px 16px rgba(35,76,117,0.30),
              0 1px 0 rgba(255,255,255,0.55) inset;
}
.primary-button:hover {
  background: linear-gradient(180deg, #4aa0c7, #285684);
  box-shadow: 0 8px 20px rgba(35,76,117,0.40),
              0 1px 0 rgba(255,255,255,0.65) inset;
}
.primary-button:active { transform: translateY(1px); }

/* Pattern interrupt overlay. The contained image animates its
   opacity and scale using keyframes defined at the end of the file. */
.interrupt {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.95);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 900;
}

.interrupt img {
  max-width: 90vmin;
  max-height: 90vmin;
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: 0.5rem;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  opacity: 0;
}

/* CSS fallback/primary visual for pattern interrupt (no external image needed) */
.interrupt .interrupt-visual {
  max-width: 90%;
  max-height: 90%;
  width: min(70vmin, 520px);
  height: min(70vmin, 520px);
  border-radius: 50%;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  background: conic-gradient(from 0deg, #8b5cf6, #22c55e, #3b82f6, #f59e0b, #ef4444, #8b5cf6);
  filter: saturate(1.1) contrast(1.05);
  opacity: 0;
}

/* Swirl-in/out animation applied via classes so JS can randomize direction */
.swirl-cw {
  animation: swirlInterruptCW var(--interrupt-duration, 3s) ease-in-out forwards;
}
.swirl-ccw {
  animation: swirlInterruptCCW var(--interrupt-duration, 3s) ease-in-out forwards;
}

@keyframes swirlInterruptCW {
  0%   { opacity: 0; transform: scale(0.05) rotate(0deg); }
  25%  { opacity: 1; transform: scale(1)    rotate(360deg); }
  75%  { opacity: 1; transform: scale(1)    rotate(360deg); }
  100% { opacity: 0; transform: scale(0.05) rotate(0deg); }
}

@keyframes swirlInterruptCCW {
  0%   { opacity: 0; transform: scale(0.05) rotate(0deg); }
  25%  { opacity: 1; transform: scale(1)    rotate(-360deg); }
  75%  { opacity: 1; transform: scale(1)    rotate(-360deg); }
  100% { opacity: 0; transform: scale(0.05) rotate(0deg); }
}

@keyframes spin {
  from { transform: rotate(0deg) scale(0.9); }
  to   { transform: rotate(360deg) scale(0.9); }
}

@keyframes fadeInterrupt {
  0% {
    opacity: 0;
    transform: scale(0.9);
  }
  25% {
    opacity: 1;
    transform: scale(1.0);
  }
  75% {
    opacity: 1;
    transform: scale(1.0);
  }
  100% {
    opacity: 0;
    transform: scale(0.9);
  }
}

/* Top bar provides persistent context to the player: the Option key
   indicator, current progress and a settings button. */
#top-bar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  min-height: 52px;
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  align-items: center;
  padding: 0.5rem 1rem;
  z-index: 800;
  box-sizing: border-box;
  column-gap: 0.5rem;
  font-size: calc(1.5rem + 3pt);
}

.top-left {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  min-width: 0;
}
.top-right {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  min-width: 0;
}
.top-center {
  text-align: center;
  margin: 0 0.5rem;
  /* allow wrapping instead of truncating */
  white-space: normal;
  overflow: visible;
  text-overflow: clip;
}

/* Prefer a LaTeX-style math font for symbols and make them larger */
.symbol-table td:first-child,
.stage2-symbol,
.choice-button {
  font-family: var(--math-font);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* Bump sizes by ~2pt in each context */
.symbol-table td:first-child { font-size: 1.6rem; line-height: 1.1; text-align: center; }
.stage2-symbol { font-size: calc(4rem + 2pt); }
.choice-button { font-size: calc(2rem + 2pt); }
.option-instruction {
  font-size: 0.9rem;
  color: var(--muted);
  white-space: nowrap;
}
@media (max-width: 600px) {
  .option-instruction { display: none; }
}

/* Option key indicator visually reflects whether the Option key is
   currently pressed.  When active it inverts colours. */
#option-indicator {
  width: 36px;
  height: 36px;
  border-radius: 0.25rem;
  background: var(--border);
  color: var(--text);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.25rem;
  transition: background 0.2s, color 0.2s;
  margin-right: 0.25rem;
}

#option-indicator.active {
  background: var(--primary);
  color: #fff;
}

/* Progress display summarises current stage and per‑symbol accuracy. */
#progress-display {
  font-size: 1rem;
  color: var(--muted);
  line-height: 1.2;
}

/* Settings button uses an inline SVG gear.  Remove default button styles to allow custom styling. */
.icon-button {
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  cursor: pointer;
  color: var(--muted);
  transition: color 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
}

.icon-button:hover {
  color: var(--primary);
}

.icon-button.with-label {
  width: auto;
  padding: 0 0.5rem;
  gap: 0.35rem;
}
.icon-button-label { font-weight: 600; color: var(--muted); }
.icon-button.with-label:hover .icon-button-label { color: #285684; }

/* Main game container occupies the remaining viewport below the top bar. */
#game-container {
  padding: 1rem;
  padding-top: var(--topbar-offset, 64px); /* dynamic space for top bar */
  max-width: 800px;
  margin: 0 auto;
  box-sizing: border-box;
  padding-bottom: var(--footer-offset, 56px); /* space for fixed footer */
}

/* Symbol table used in Stage 1. */
table.symbol-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
  table-layout: fixed;
}

table.symbol-table th,
table.symbol-table td {
  padding: 0.5rem;
  border-bottom: 1px solid var(--border);
  overflow-wrap: break-word;
}

/* Center column headers */
table.symbol-table th { text-align: center; }

/* Default body cells left (overrides below keep Symbol/Code centered) */
table.symbol-table td { text-align: center; }

table.symbol-table th {
  font-weight: 600;
  color: var(--muted);
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

table.symbol-table tr.highlight {
  background: #eef2ff;
}

table.symbol-table tr.complete {
  color: var(--muted);
}

table.symbol-table td.code {
  font-family: "SF Mono", "Courier New", monospace;
  font-size: 1.1rem;
  text-align: center;
}

table.symbol-table td.code span.correct {
  color: var(--success);
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.2);
}

table.symbol-table td.code span.pending {
  color: var(--muted);
}

/* Stage 2: active recall layout. */
.stage2-container {
  text-align: center;
  margin-top: 2rem;
}

.stage2-symbol {
  font-size: 4rem;
  color: var(--primary);
  margin-bottom: 1rem;
  user-select: none;
}

.stage2-hint {
  font-family: "SF Mono", "Courier New", monospace;
  font-size: 2rem;
  margin-bottom: 1rem;
  min-height: 2.5rem;
}

#stage2-timer {
  width: 100%;
  max-width: 300px;
  height: 12px;
  background-color: #e5e7eb;
  border-radius: 6px;
  margin: 1.5rem auto 0;
  overflow: hidden;
  border: 1px solid #d1d5db;
}

#stage2-timer-bar {
  height: 100%;
  width: 100%;
  background-color: var(--primary);
  border-radius: 6px;
  transform-origin: left center;
  transition: transform 0.2s linear, background-color 0.3s ease;
}

#stage2-timer-bar.low-time {
  background-color: #ef4444; /* red */
}

#stage2-start-prompt {
  margin-top: 2rem;
  font-family: 'Lato', -apple-system, system-ui, sans-serif;
  font-weight: 700;
  font-size: 2rem;
  color: var(--muted);
  text-align: center;
  animation: fadeInPrompt 0.5s ease-out;
}

@keyframes fadeInPrompt {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Apply the pulsing animation */
#stage2-start-prompt.prompt-animated {
  /* Animation 1: Fades in once. Animation 2: Pulses forever after a 0.5s delay. */
  animation: fadeInPrompt 0.5s ease-out, pulseColor 8.5s ease-in-out 0.5s infinite;
}

@keyframes fadeInPrompt {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes pulseColor {
  0%   { color: var(--primary); }
  50%  { color: var(--notcringeyblue); }
  100% { color: var(--primary); }
}

/* Defines the color-shifting animation */
@keyframes pulseColor {
  0%   { color: var(--primary); }
  50%  { color: var(--notcringeyblue); }
  100% { color: var(--primary); }
}

.reinforcement-table {
  margin-top: 1.5rem;
  border: 1px solid var(--border);
  padding: 0.5rem;
  border-radius: 0.25rem;
  background: var(--surface);
  animation: fadeReinforcement 0.5s ease-in-out;
}

@keyframes fadeReinforcement {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Stage 3: recognition quiz. */
.stage3-container {
  text-align: center;
  margin-top: 2rem;
}

.stage3-code {
  font-family: "SF Mono", "Courier New", monospace;
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.choices {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 1rem;
  margin-top: 1rem;
}

.choice-button {
  font-size: 2rem;
  padding: 0.5rem 1rem;
  background: var(--surface);
  border: 2px solid var(--border);
  border-radius: 0.5rem;
  cursor: pointer;
  transition: background 0.2s, border-color 0.2s;
  user-select: none;
}

.choice-button:hover {
  background: #f1f5ff;
}

.choice-button.correct {
  border-color: var(--success);
  background: #dcfce7;
  color: var(--success);
}

.choice-button.wrong {
  border-color: var(--error);
  background: #fee2e2;
  color: var(--error);
}

/* Scoreboard for Stage 3. */
.scoreboard {
  margin-top: 1.5rem;
  font-size: 1.1rem;
  color: var(--muted);
}

/* Flash animations for feedback. 
These are applied via JS on success or error at the row level in Stage 1. */
@keyframes flashGreen {
  0% { background: #dcfce7; }
  50% { background: #dcfce7; }
  100% { background: inherit; }
}

@keyframes flashRed {
  0% { background: #fee2e2; }
  50% { background: #fee2e2; }
  100% { background: inherit; }
}

/* Responsive adjustments. */
@media (max-width: 600px) {
  #game-container {
    padding: 0.5rem;
    padding-top: 56px;
  }
  .stage2-symbol {
    font-size: 3rem;
  }
  .stage2-hint {
    font-size: 1.5rem;
  }
  .choice-button {
    font-size: 1.5rem;
    padding: 0.5rem;
  }
}
/* Settings: pack overview grid (4 columns) */
.overview-table {
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
  border-spacing: 0.5rem 0.35rem;
}
.overview-table td {
  vertical-align: middle;
  padding: 0.5rem 0.55rem;
  min-height: 3rem;
  min-width: 150px;
  text-align: center;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  background: var(--surface);
  height: var(--ov-cell-h, auto);
}

/* Style for cells containing symbols currently in the game */
#pack-overview-table td.active-symbol {
  background-color: #D8F0F2;
  cursor: pointer;
  transition: background-color 0.2s ease-in-out;
}

/* Style for cells with symbols NOT in the game */
#pack-overview-table td.inactive-symbol {
  cursor: pointer;
  transition: background-color 0.2s ease-in-out;
}

/* A subtle hover effect for inactive symbols to show they are clickable */
#pack-overview-table td.inactive-symbol:hover {
  background-color: #e9e9e9;
}

/* A slightly darker hover for active symbols */
#pack-overview-table td.active-symbol:hover {
  background-color: #cce3e6;
}
/* Hide the look of empty cells but keep their grid space */
.overview-table td:empty {
  border-color: transparent;
  background: transparent;
}
.overview-table .ov-symbol {
  font-family: var(--math-font);
  font-size: 1.35rem;
  margin-right: 0.35rem;
  line-height: 1.1;
}
.overview-table .ov-name {
  color: var(--muted);
  font-size: 0.95rem;
  white-space: normal;   /* allow wrapping between name and (qualifier) */
  overflow: visible;     /* no clipping */
  text-overflow: clip;   /* disable ellipsis */
}

.settings-tip {
  margin: 0.25rem 0 0.75rem;
  color: var(--muted);
  font-size: 0.95rem;
}

/* Use the selected math font for the Stage 1 header symbol list */
#progress-display .symbols { font-family: var(--math-font);
font-size: 1.3rem;
}

/* When Latin Modern Math is selected, bump Stage 1 symbols slightly */
.font-LatinModernMath .symbol-table td:first-child { font-size: 1.7rem; }
/* Label above the overview grid */
.section-label { 
  margin: 0.25rem 0 0.35rem; 
  font-size: 0.95rem; 
  color: var(--muted); 
  font-weight: 600; 
  letter-spacing: .02em; 
}

/* Polished Settings title (slightly larger, underline accent, subtle shadow, hover tracking) */
.settings-title {
  font-size: calc(100% + 4pt);
  color: #234C75;
  display: inline-block;            /* so the underline sizes nicely */
  position: relative;
  letter-spacing: .02em;
  text-shadow: 0 0.5px 0 rgba(0,0,0,0.18);
  transition: letter-spacing .2s ease, text-shadow .2s ease;
}
.settings-title:hover { letter-spacing: .04em; text-shadow: 0 0.6px 0 rgba(0,0,0,0.22); }
.settings-title::after {
  content: "";
  display: block;
  height: 3px;
  width: 34px;
  margin-top: .4rem;
  border-radius: 2px;
  background: linear-gradient(90deg, #234C75, #17314C);
  transform-origin: left center;
  transform: scaleX(0);
}
/* Animate the underline each time the modal opens */
.modal:not(.hidden) .settings-title::after { animation: titleUnderline .35s ease-out .06s forwards; }
@keyframes titleUnderline { from { transform: scaleX(0); } to { transform: scaleX(1); } }
/* Settings tip text style */
.settings-tip {
  margin: 0.25rem 0 0.75rem;
  color: var(--muted);
  font-size: 0.95rem;
}
/* Inline row for controls; wrap cleanly without overlap */
.form-row { display: flex; align-items: center; gap: .75rem; flex-wrap: wrap; }

/* Pack selector gets a bit more room */
 .form-row .grow  { flex: 1 1 260px; min-width: 200px; max-width: 300px; }
/* Smaller controls share the remaining space; allow wrap */
.form-row .shrink{ flex: 1 1 220px; min-width: 200px; max-width: 300px; }

#onboarding .form-row, #settings-modal .form-row { justify-content: flex-start; }
#onboarding .form-row .form-group, #settings-modal .form-row .form-group { margin-bottom: 0; }

/* Keep label on the left and ensure the select cannot overflow the group */
.form-row .form-group { display: flex; align-items: center; gap: .5rem; min-width: 200px; }
.form-row .form-group label { margin: 0; white-space: nowrap; }
.form-row .form-group select { flex: 1 1 auto; min-width: 0; max-width: 100%; }

/* Settings modal: make selects/labels a touch smaller and avoid oversized widths */
#settings-modal select { font-size: .8rem; height: 32px; min-width: 120px; }
#settings-modal label  { font-size: .8rem; }
#settings-modal .form-row .grow  { flex: 1 1 260px; max-width: 300px; }

/* Add a bit of space below the first settings row */
#settings-modal .form-row { margin-bottom: .9rem; }

/* Global footer */
#game-footer {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  min-height: 52px;
  background: var(--surface);
  border-top: 1px solid var(--border);
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  padding: 0.5rem 1rem;
  box-sizing: border-box;
  z-index: 800;
  column-gap: 0.5rem;
}
#game-footer .footer-center {
  display: flex;
  justify-content: center;
}
#game-footer .footer-right {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 0.9rem;
  color: var(--muted);
  font-size: 0.95rem;
  flex-wrap: wrap;
}
#game-footer .footer-counter {
  white-space: nowrap;
}
.primary-button.small {
  padding: 0.5rem 1rem;
  font-size: 0.95rem;
}

#debug-panel {
  box-sizing: border-box;
  width: 100%;
  max-width: 800px;
  margin: 0 auto 0.5rem auto;
  padding: 0.6rem 0.9rem 0.9rem;
  background: var(--surface);
  border-top: 1px dashed var(--border);
  border-bottom: 1px dashed var(--border);
  color: #111;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 13px;
}
#debug-panel .debug-title {
  font-weight: 700;
  color: var(--muted);
  text-align: center;
  margin: 0 0 .35rem 0;
}
#debug-panel .muted {
  color: var(--muted);
  text-align: center;
  margin: 0 0 .5rem 0;
}
#debug-panel table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}
#debug-panel thead th {
  background: #f3f4f6;
  color: #374151;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: .03em;
  font-size: 12px;
}
#debug-panel th, #debug-panel td {
  border: 1px solid var(--border);
  padding: 0.35rem 0.45rem;
  text-align: center;
  vertical-align: top;
  word-break: break-word;
}
#debug-panel tbody tr:nth-child(odd) {
  background: #fafbff;
}


/* Tooltip styles for info icons */
.js-tooltip-icon {
  display: inline-block;
  width: 16px;
  height: 16px;
  line-height: 16px;
  text-align: center;
  border-radius: 50%;
  border: 1px solid var(--muted);
  color: var(--muted);
  font-size: 12px;
  font-weight: bold;
  margin-left: 6px;
  cursor: help;
}
.global-tooltip-popup {
  position: fixed; /* Use "fixed" to float on top of everything, ignore all containers. */
  z-index: 2000; /* high z-index to ensure it's on top. */
  background-color: rgba(31, 41, 55, 0.85);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  color: #f9fafb;
  padding: 8px 12px;
  border-radius: 6px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
  width: max-content;
  max-width: 320px;
  text-align: left;
  font-family: -apple-system, system-ui, 'Helvetica Neue', sans-serif;
  font-weight: normal;
  font-size: 14px;
  line-height: 1.5;
  pointer-events: none; /* Prevents the tooltip itself from being clicked. */
  white-space: pre-wrap;
  transform: translateY(5px);
  transition: opacity 0.2s ease-out, transform 0.2s ease-out;
}

.global-tooltip-popup.visible {
  opacity: 1;
  transform: translateY(0);
}